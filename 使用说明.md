# Discord 频道导出工具 - 使用说明

## 🎯 主要功能

### 1. 支持的频道类型
- **论坛频道**（Forum Channel）：自动获取所有帖子及其消息
- **普通文字频道**（Text Channel）：获取频道内的所有消息

### 2. 时间筛选功能 ⏰

#### 精确时间选择
- 可以选择**年、月、日、小时、分钟**
- 格式示例：`2026-03-02 14:30`（2026年3月2日下午2点30分）

#### 使用场景
```
场景 1：导出某天上午的聊天记录
  开始时间：2026-03-02 09:00
  结束时间：2026-03-02 12:00

场景 2：导出跨天的夜间聊天
  开始时间：2026-03-01 20:00
  结束时间：2026-03-02 02:00

场景 3：导出某个时间点之后的所有消息
  开始时间：2026-03-02 15:30
  结束时间：留空

场景 4：导出某个时间点之前的所有消息
  开始时间：留空
  结束时间：2026-03-02 18:00

场景 5：导出全部消息
  开始时间：留空
  结束时间：留空
```

### 3. 导出格式

#### Excel (推荐) 📊
- 结构化表格，包含所有字段
- 列宽自动调整
- 标题行带颜色标记
- 适合数据分析和筛选

#### TXT 📝
- 纯文本格式
- 保持对话流畅性
- 文件体积小
- 适合快速浏览

#### HTML 🌐
- 类似 Discord 界面的样式
- 可在浏览器中直接查看
- 支持点击链接跳转到原消息
- 适合分享和展示

## 📋 使用步骤

### 第一步：设置 Bot Token

1. 访问 [Discord Developer Portal](https://discord.com/developers/applications)
2. 创建新应用或选择现有应用
3. 进入 Bot 页面
4. 复制 Bot Token
5. 在工具中粘贴 Token 并保存

**注意**：Token 请妥善保管，不要泄露！

### 第二步：获取频道链接

1. 在 Discord 中右键点击频道
2. 选择"复制链接"
3. 链接格式：`https://discord.com/channels/服务器ID/频道ID`

### 第三步：配置导出选项

1. **粘贴频道链接**：可以一次性导出多个频道（每行一个链接）
2. **选择时间范围**（可选）：
   - 点击"开始时间"输入框，选择日期和时间
   - 点击"结束时间"输入框，选择日期和时间
3. **选择导出格式**：Excel / TXT / HTML

### 第四步：开始导出

1. 点击"开始导出"按钮
2. 等待处理（会显示实时进度）
3. 完成后点击"下载文件"

## ⚙️ 技术说明

### 时间处理
- 所有时间均使用本地时区
- 消息时间基于 Discord Snowflake ID 计算
- 时间精度：秒级

### 性能优化
- 后台异步处理，避免浏览器超时
- 自动处理 API 速率限制
- 批量获取消息（每次100条）

### 数据完整性
- 包含消息的所有基本信息
- 保留附件链接
- 记录原始消息链接

## 🐛 常见问题

### Q: 为什么导出很慢？
A: Discord API 有速率限制，大量消息需要时间。程序会自动处理限制，请耐心等待。

### Q: 可以导出私信吗？
A: 目前仅支持服务器频道，不支持私信。

### Q: 导出的时间范围是如何工作的？
A: 
- 开始时间：只导出该时间**之后**的消息
- 结束时间：只导出该时间**之前**的消息
- 两个都设置：导出该时间段内的消息

### Q: Bot 需要什么权限？
A: Bot 需要：
- 查看频道（View Channel）
- 读取消息历史（Read Message History）
- 对于论坛频道，需要能读取公开帖子

### Q: 时间选择器显示不正确？
A: 确保使用较新版本的浏览器。推荐使用：
- Chrome 90+
- Edge 90+
- Firefox 88+
- Safari 14.1+

## 📞 支持

遇到问题？欢迎在 GitHub 提交 Issue！
